import{e as $,u as F,f as K}from"../chunks/global.DC77a2-V.js";import{s as L,n as T,r as Q,j as q}from"../chunks/scheduler.Dgi1yRhy.js";import{S as W,i as X,e as p,c as _,a as E,d as v,b as M,s as w,k as C,g as A,l as h,m as u,r as B,q as N,E as Z,n as z,o as G,p as H}from"../chunks/index._uay1wRk.js";import{h as U,u as x}from"../chunks/await_block.CqJELAkV.js";import{e as J}from"../chunks/each.G4N-V4Bk.js";import{g as ee}from"../chunks/entry.BBIJJ-6L.js";const te=async()=>{try{const s=await fetch(`http://localhost:3000/api/groupchat/getMessage?block_no=${$}`);if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);return{streamed:{messages:(await s.json()).response[0].messages}}}catch(s){return console.error("Error fetching messages:",s),{streamed:{messages:[]}}}},fe=Object.freeze(Object.defineProperty({__proto__:null,load:te},Symbol.toStringTag,{value:"Module"}));function R(s,e,a){const t=s.slice();return t[5]=e[a],t}function se(s){return{c:T,l:T,m:T,p:T,d:T}}function ae(s){let e,a,t,n,c,i,f,m,b="Send",P,S,k=J(s[0].streamed.messages),o=[];for(let l=0;l<k.length;l+=1)o[l]=Y(R(s,k,l));return{c(){e=p("div"),a=p("div"),t=p("div");for(let l=0;l<o.length;l+=1)o[l].c();n=w(),c=p("div"),i=p("input"),f=w(),m=p("button"),m.textContent=b,this.h()},l(l){e=_(l,"DIV",{class:!0});var y=E(e);a=_(y,"DIV",{class:!0});var r=E(a);t=_(r,"DIV",{class:!0});var g=E(t);for(let D=0;D<o.length;D+=1)o[D].l(g);g.forEach(v),r.forEach(v),n=C(y),c=_(y,"DIV",{class:!0});var d=E(c);i=_(d,"INPUT",{type:!0,placeholder:!0,class:!0}),f=C(d),m=_(d,"BUTTON",{class:!0,"data-svelte-h":!0}),A(m)!=="svelte-93q973"&&(m.textContent=b),d.forEach(v),y.forEach(v),this.h()},h(){h(t,"class","conversation-container svelte-ghf53y"),h(a,"class","scrollable-container svelte-ghf53y"),h(i,"type","text"),h(i,"placeholder","Type your message..."),h(i,"class","svelte-ghf53y"),h(m,"class","svelte-ghf53y"),h(c,"class","input-container svelte-ghf53y"),h(e,"class","wrapper svelte-ghf53y")},m(l,y){M(l,e,y),u(e,a),u(a,t);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(t,null);u(e,n),u(e,c),u(c,i),B(i,s[1]),u(c,f),u(c,m),P||(S=[N(i,"input",s[3]),N(m,"click",s[2])],P=!0)},p(l,y){if(y&1){k=J(l[0].streamed.messages);let r;for(r=0;r<k.length;r+=1){const g=R(l,k,r);o[r]?o[r].p(g,y):(o[r]=Y(g),o[r].c(),o[r].m(t,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=k.length}y&2&&i.value!==l[1]&&B(i,l[1])},d(l){l&&v(e),Z(o,l),P=!1,Q(S)}}}function Y(s){let e,a,t,n,c,i,f,m,b=s[5].name+"",P,S,k,o=s[5].message+"",l,y,r;return{c(){e=p("div"),a=p("div"),t=p("img"),c=w(),i=p("div"),f=p("p"),m=p("strong"),P=z(b),S=w(),k=p("p"),l=z(o),y=w(),this.h()},l(g){e=_(g,"DIV",{class:!0});var d=E(e);a=_(d,"DIV",{class:!0});var D=E(a);t=_(D,"IMG",{src:!0,alt:!0,class:!0}),D.forEach(v),c=C(d),i=_(d,"DIV",{class:!0});var I=E(i);f=_(I,"P",{class:!0});var O=E(f);m=_(O,"STRONG",{});var V=E(m);P=G(V,b),V.forEach(v),O.forEach(v),S=C(I),k=_(I,"P",{class:!0});var j=E(k);l=G(j,o),j.forEach(v),I.forEach(v),y=C(d),d.forEach(v),this.h()},h(){q(t.src,n="http://localhost:3000/api/profile/getProfilePicture?user_id="+s[5].user_id)||h(t,"src",n),h(t,"alt",""),h(t,"class","user-avatar svelte-ghf53y"),h(a,"class","user-image svelte-ghf53y"),h(f,"class","svelte-ghf53y"),h(k,"class","svelte-ghf53y"),h(i,"class","message-content svelte-ghf53y"),h(e,"class",r="message-container "+(s[5].sender==="manager"?"manager-message":"")+" svelte-ghf53y")},m(g,d){M(g,e,d),u(e,a),u(a,t),u(e,c),u(e,i),u(i,f),u(f,m),u(m,P),u(i,S),u(i,k),u(k,l),u(e,y)},p(g,d){d&1&&!q(t.src,n="http://localhost:3000/api/profile/getProfilePicture?user_id="+g[5].user_id)&&h(t,"src",n),d&1&&b!==(b=g[5].name+"")&&H(P,b),d&1&&o!==(o=g[5].message+"")&&H(l,o),d&1&&r!==(r="message-container "+(g[5].sender==="manager"?"manager-message":"")+" svelte-ghf53y")&&h(e,"class",r)},d(g){g&&v(e)}}}function le(s){let e,a="loading";return{c(){e=p("p"),e.textContent=a},l(t){e=_(t,"P",{"data-svelte-h":!0}),A(e)!=="svelte-1ecjz70"&&(e.textContent=a)},m(t,n){M(t,e,n)},p:T,d(t){t&&v(e)}}}function re(s){let e,a,t={ctx:s,current:null,token:null,hasCatch:!1,pending:le,then:ae,catch:se,value:4};return U(a=s[0].streamed.messages,t),{c(){e=p("body"),t.block.c()},l(n){e=_(n,"BODY",{});var c=E(e);t.block.l(c),c.forEach(v)},m(n,c){M(n,e,c),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null},p(n,[c]){s=n,t.ctx=s,c&1&&a!==(a=s[0].streamed.messages)&&U(a,t)||x(t,s,c)},i:T,o:T,d(n){n&&v(e),t.block.d(),t.token=null,t=null}}}function ne(s,e,a){let{data:t}=e,n="";function c(){let f=n;fetch("http://localhost:3000/api/groupchat/addMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:F,block_no:$,sender:K,message:f})}).then(b=>{if(!b.ok)throw new Error(`HTTP error! Status: ${b.status}`);console.log("Message sent successfully"),f="",ee("/loginpage/components/user/groupchat/chat1")}).catch(b=>{console.error("Error sending message:",b)})}function i(){n=this.value,a(1,n)}return s.$$set=f=>{"data"in f&&a(0,t=f.data)},[t,n,c,i]}class ge extends W{constructor(e){super(),X(this,e,ne,re,L,{data:0})}}export{ge as component,fe as universal};
